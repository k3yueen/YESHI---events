import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log('üå± Seeding database...');

  // Create cities
  const bucharest = await prisma.city.upsert({
    where: { slug: 'bucharest' },
    update: {},
    create: {
      slug: 'bucharest',
      name: 'Bucharest',
      nameRo: 'Bucure»ôti',
      nameEn: 'Bucharest',
      lat: 44.4268,
      lng: 26.1025,
    },
  });

  const constanta = await prisma.city.upsert({
    where: { slug: 'constanta' },
    update: {},
    create: {
      slug: 'constanta',
      name: 'Constan»õa',
      nameRo: 'Constan»õa',
      nameEn: 'Constan»õa',
      lat: 44.1733,
      lng: 28.6383,
    },
  });

  console.log('‚úÖ Cities created');

  // Create categories
  const categories = await Promise.all([
    prisma.category.upsert({
      where: { name: 'restaurant' },
      update: {},
      create: {
        name: 'restaurant',
        nameRo: 'Restaurant',
        nameEn: 'Restaurant',
        icon: 'üç¥',
      },
    }),
    prisma.category.upsert({
      where: { name: 'cafe' },
      update: {},
      create: {
        name: 'cafe',
        nameRo: 'Cafenea',
        nameEn: 'Caf√©',
        icon: '‚òï',
      },
    }),
    prisma.category.upsert({
      where: { name: 'bar' },
      update: {},
      create: {
        name: 'bar',
        nameRo: 'Bar',
        nameEn: 'Bar',
        icon: 'üçπ',
      },
    }),
    prisma.category.upsert({
      where: { name: 'rooftop' },
      update: {},
      create: {
        name: 'rooftop',
        nameRo: 'TerasƒÉ pe Acoperi»ô',
        nameEn: 'Rooftop',
        icon: 'üèôÔ∏è',
      },
    }),
    prisma.category.upsert({
      where: { name: 'wineBar' },
      update: {},
      create: {
        name: 'wineBar',
        nameRo: 'Bar de Vinuri',
        nameEn: 'Wine Bar',
        icon: 'üç∑',
      },
    }),
  ]);

  console.log('‚úÖ Categories created');

  // Create features
  const features = await Promise.all([
    prisma.feature.upsert({
      where: { name: 'petFriendly' },
      update: {},
      create: {
        name: 'petFriendly',
        nameRo: 'Prietenos cu Animalele',
        nameEn: 'Pet Friendly',
        icon: 'üêï',
      },
    }),
    prisma.feature.upsert({
      where: { name: 'outdoorSeating' },
      update: {},
      create: {
        name: 'outdoorSeating',
        nameRo: 'Locuri √Æn Aer Liber',
        nameEn: 'Outdoor Seating',
        icon: 'üå≥',
      },
    }),
    prisma.feature.upsert({
      where: { name: 'specialtyCoffee' },
      update: {},
      create: {
        name: 'specialtyCoffee',
        nameRo: 'Cafea SpecialƒÉ',
        nameEn: 'Specialty Coffee',
        icon: '‚òï',
      },
    }),
    prisma.feature.upsert({
      where: { name: 'sunsetView' },
      update: {},
      create: {
        name: 'sunsetView',
        nameRo: 'Vedere la Apus',
        nameEn: 'Sunset View',
        icon: 'üåÖ',
      },
    }),
    prisma.feature.upsert({
      where: { name: 'liveMusic' },
      update: {},
      create: {
        name: 'liveMusic',
        nameRo: 'MuzicƒÉ Live',
        nameEn: 'Live Music',
        icon: 'üéµ',
      },
    }),
  ]);

  console.log('‚úÖ Features created');

  // Create sample spots
  const spots = await Promise.all([
    // Bucharest spots
    prisma.spot.upsert({
      where: { slug: 'cafe-central' },
      update: {},
      create: {
        slug: 'cafe-central',
        name: 'Caf√© Central',
        nameRo: 'Caf√© Central',
        nameEn: 'Central Caf√©',
        about: 'A cozy caf√© in the heart of Bucharest',
        aboutRo: 'O cafenea primitoare √Æn inima Bucure»ôtiului',
        aboutEn: 'A cozy caf√© in the heart of Bucharest',
        address: 'Strada Lipscani 1, Bucure»ôti',
        cityId: bucharest.id,
        lat: 44.4268,
        lng: 26.1025,
        category: 'cafe',
        isNew: true,
        priceTier: 'MODERATE',
        openedAt: new Date('2024-01-15'),
      },
    }),
    prisma.spot.upsert({
      where: { slug: 'rooftop-garden' },
      update: {},
      create: {
        slug: 'rooftop-garden',
        name: 'Rooftop Garden',
        nameRo: 'GrƒÉdina de pe Acoperi»ô',
        nameEn: 'Rooftop Garden',
        about: 'Elegant rooftop restaurant with city views',
        aboutRo: 'Restaurant elegant pe acoperi»ô cu vedere la ora»ô',
        aboutEn: 'Elegant rooftop restaurant with city views',
        address: 'Strada Victoriei 100, Bucure»ôti',
        cityId: bucharest.id,
        lat: 44.4368,
        lng: 26.0925,
        category: 'restaurant',
        isNew: false,
        priceTier: 'PREMIUM',
        openedAt: new Date('2023-06-20'),
      },
    }),
    prisma.spot.upsert({
      where: { slug: 'wine-cellar' },
      update: {},
      create: {
        slug: 'wine-cellar',
        name: 'Wine Cellar',
        nameRo: 'Pivni»õa de Vinuri',
        nameEn: 'Wine Cellar',
        about: 'Intimate wine bar with Romanian wines',
        aboutRo: 'Bar intim de vinuri cu vinuri rom√¢ne»ôti',
        aboutEn: 'Intimate wine bar with Romanian wines',
        address: 'Strada Sm√¢rdan 15, Bucure»ôti',
        cityId: bucharest.id,
        lat: 44.4168,
        lng: 26.1125,
        category: 'wineBar',
        isNew: true,
        priceTier: 'PREMIUM',
        openedAt: new Date('2024-03-10'),
      },
    }),

    // Constan»õa spots
    prisma.spot.upsert({
      where: { slug: 'seaside-lounge' },
      update: {},
      create: {
        slug: 'seaside-lounge',
        name: 'Seaside Lounge',
        nameRo: 'Lounge-ul de pe Malul MƒÉrii',
        nameEn: 'Seaside Lounge',
        about: 'Beachfront bar with sunset views',
        aboutRo: 'Bar pe malul mƒÉrii cu vedere la apus',
        aboutEn: 'Beachfront bar with sunset views',
        address: 'Bulevardul Mamaia 100, Constan»õa',
        cityId: constanta.id,
        lat: 44.1733,
        lng: 28.6383,
        category: 'bar',
        isNew: true,
        priceTier: 'MODERATE',
        openedAt: new Date('2024-02-28'),
      },
    }),
    prisma.spot.upsert({
      where: { slug: 'coastal-cafe' },
      update: {},
      create: {
        slug: 'coastal-cafe',
        name: 'Coastal Caf√©',
        nameRo: 'Cafenea de pe CoastƒÉ',
        nameEn: 'Coastal Caf√©',
        about: 'Relaxing caf√© by the sea',
        aboutRo: 'Cafenea relaxantƒÉ l√¢ngƒÉ mare',
        aboutEn: 'Relaxing caf√© by the sea',
        address: 'Bulevardul Tomis 50, Constan»õa',
        cityId: constanta.id,
        lat: 44.1833,
        lng: 28.6283,
        category: 'cafe',
        isNew: false,
        priceTier: 'BUDGET',
        openedAt: new Date('2023-08-15'),
      },
    }),
  ]);

  console.log('‚úÖ Spots created');

  // Create sample promos
  const promos = await Promise.all([
    prisma.promo.upsert({
      where: { id: 'promo-1' },
      update: {},
      create: {
        id: 'promo-1',
        title: 'Happy Hour Special',
        titleRo: 'OfertƒÉ Happy Hour',
        titleEn: 'Happy Hour Special',
        description: '50% off all cocktails from 5-7 PM',
        descriptionRo: '50% reducere la toate cocktailurile de la 17:00-19:00',
        descriptionEn: '50% off all cocktails from 5-7 PM',
        spotId: spots[0].id, // Caf√© Central
        startsAt: new Date('2024-08-20T17:00:00Z'),
        endsAt: new Date('2024-08-20T19:00:00Z'),
        isActive: true,
      },
    }),
    prisma.promo.upsert({
      where: { id: 'promo-2' },
      update: {},
      create: {
        id: 'promo-2',
        title: 'Weekend Brunch',
        titleRo: 'Brunch de Weekend',
        titleEn: 'Weekend Brunch',
        description: 'Free coffee with any brunch order',
        descriptionRo: 'Cafea gratuitƒÉ cu orice comandƒÉ de brunch',
        descriptionEn: 'Free coffee with any brunch order',
        spotId: spots[1].id, // Rooftop Garden
        startsAt: new Date('2024-08-24T10:00:00Z'),
        endsAt: new Date('2024-08-25T14:00:00Z'),
        isActive: true,
      },
    }),
  ]);

  console.log('‚úÖ Promos created');

  // Create sample collections
  const collections = await Promise.all([
    prisma.collection.upsert({
      where: { id: 'collection-1' },
      update: {},
      create: {
        id: 'collection-1',
        name: 'New in Bucharest',
        nameRo: 'Nou √Æn Bucure»ôti',
        nameEn: 'New in Bucharest',
        description: 'Discover the newest spots in Bucharest',
        descriptionRo: 'DescoperƒÉ cele mai noi locuri din Bucure»ôti',
        descriptionEn: 'Discover the newest spots in Bucharest',
        isPublic: true,
        isEditorial: true,
        userId: 'system', // This would be a real user ID in production
      },
    }),
    prisma.collection.upsert({
      where: { id: 'collection-2' },
      update: {},
      create: {
        id: 'collection-2',
        name: 'Seaside Spots',
        nameRo: 'Locuri pe Malul MƒÉrii',
        nameEn: 'Seaside Spots',
        description: 'Best places by the sea in Constan»õa',
        descriptionRo: 'Cele mai bune locuri pe malul mƒÉrii din Constan»õa',
        descriptionEn: 'Best places by the sea in Constan»õa',
        isPublic: true,
        isEditorial: true,
        userId: 'system',
      },
    }),
  ]);

  console.log('‚úÖ Collections created');

  // Add spots to collections
  await Promise.all([
    prisma.collectionSpot.upsert({
      where: { id: 'cs-1' },
      update: {},
      create: {
        id: 'cs-1',
        collectionId: collections[0].id,
        spotId: spots[0].id,
        order: 1,
      },
    }),
    prisma.collectionSpot.upsert({
      where: { id: 'cs-2' },
      update: {},
      create: {
        id: 'cs-2',
        collectionId: collections[0].id,
        spotId: spots[1].id,
        order: 2,
      },
    }),
    prisma.collectionSpot.upsert({
      where: { id: 'cs-3' },
      update: {},
      create: {
        id: 'cs-3',
        collectionId: collections[1].id,
        spotId: spots[3].id,
        order: 1,
      },
    }),
  ]);

  console.log('‚úÖ Collection spots created');

  console.log('üéâ Database seeded successfully!');
}

main()
  .catch((e) => {
    console.error('‚ùå Error seeding database:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
